@model  DatingProjekt.Models.And
@{
    ViewBag.Title = "Profile";
    Layout = "~/Views/Shared/_LayoutInloggad.cshtml";
}
<div class="alla">
<div class="bild">
    <img src="~/Content/Images/@Model.Profilbild" class="img-rounded" alt="hej">
    <br /><br />
    <div class="knappar">
    @using (Html.BeginForm("UserPicture", "Picture", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
        <label class="btn btn-info">
            <input name="file" type="file" style="display: none" />
            Välj bild
        </label>
                <label class="btn btn-info">
                    <input type="submit" value="Change Profile" style="display: none" />
                    Ladda upp
                </label>
            }
        </div>
   </div>
<div class="ProfilInfo">
    <p>Namn: @Model.Förnamn @Model.Efternamn</p>
    <p>Ålder: @Model.Ålder</p>
    @if (@Model.Kön)
    { <p>Kön: Hane</p> }
    else
    { <p>Kön: Hona</p> }
</div>
    </div>
<div class="helaprofilen">
    <div class="col-md-8 col-centered" id="minEgnaDiv">
        <div class="well">
            <h3>Write on my wall! </h3>
            <br />

            <div class="input-group" id="textAreaMiddle">
                <textarea class="form-control input-sm chat-input" id="textAreaId" rows="8" cols="200" placeholder="Write your message here..."></textarea>

                <span>
                    <button class="btn btn-info" id="buttonAddPost">Add post</button>
                </span>
            </div>
            <br />
            <br />

            <div class="well" id="messages">

            </div>

        </div>

    </div>

    <script type="text/javascript">


        $(function () {
            //Hämtar alla meddelande den valda usern har fått.
            $.get('../APIControllers/Message/hamtaMeddelanden?and=' + '@Model.Användarnamn', function (data) {
                $.each(data.Message, function () {
                    $('#messages').prepend('<h5>Message: ' + this.Message + '</h5> <br/>');
                    $('#messages').prepend('<div class = "well"> <h4>From: ' + '@Model.Användarnamn' + '</h4>');
                    $('#messages').append('<br/>');
                    $('#messages').append('</div>');

                });
            });

            //Skapar funktionallitet för att skicka ett meddelande
            $('#buttonAddPost').click(function () {
                var messageText = $('#textAreaId').val();
                var userName = '@Model.Användarnamn';
                $.post("../APIControllers/Message/PostMessage?recieverUsername=" + userName + "&Message=" + messageText,
                    function () {
                        alert("Message sent!");
                        location.reload();
                    });
            });




        });
    </script>
</div>

